# Design Use Cases

## D7 (v2) [[Updated from D7 (v1)]](../sprint_3)

1. **Title**: Init Receiver (InitRx)
2. **Purpose**: To allow a remote endpoint to start a new simulation
3. **Actors**: Simulation Engine, Remote Endpoint
4. **Preconditions**:
    - The simulation engine is connected to a message queue service such as RabbitMQ
5. **Main Flow**:
    - Remote endpoint publishes a new init message to the init queue
    - The simulation engine reads the message from the init queue
    - The simulation engine deserializes the init message into a simulation `Config`
    - The simulation engine starts a new simulation with the provided `Config`
    - The simulation engine attaches a metrics transmitter to the simulation instance (to forward aggregated metrics to the remote endpoint)
    - _The simulation engine attaches an event transmitter to the simulation instance (to forward some select events generated by the simulation as a feedback mechanism to the remote endpoint)_
    - The simulation engine attaches a command receiver to the simulation instance (so that the remote endpoint can send commands to the simulation and interact with it)
6. **Alternative Flow**:
    - the remote endpoint sends an invalid init message
    - the simulation engine silently drops the message and continues
7. **Postcondition**:
    - A new simulation instance is running

### D11 (v2) [[Updated from D11 (v2)]](../sprint_3)

1. **Title**: Manage game messages
2. **Purpose**: Connect a Sim engine instance to the UI displayed to a User
3. **Actors**: Api Server
4. **Preconditions**:
    - A game has been created and UI is using STOMP via connected websocket
    - RabbitMQ is running and connected to API Server
5. **Main Flow**:
    - API Server listens to the appropriate Rabbit Queue for game _notifications_ and when a message is received forward via a STOMP endpoint using the sim UUID
    - API Server listens to game commands STOMP endpoint and forwards message to appropriate Rabbit Exchange using sim UUID
6. **Postcondition**:
    - Game _notification_ messages are forwarded to UI
    - Game command messages are forwarded to Sim via Rabbit

## D14 (v1)

1. **Title**: Event Transmitter (EventTx)
2. **Purpose**: To forward select events from a simulation's event log to remote endpoints to serve as feedback messages
3. **Actors**: Simulation Engine, Remote Endpoint
4. **Preconditions**:
    - The simulation engine is connected to a message queue service such as RabbitMQ
    - The event transmitter is subscribed to the running simulation's event log
5. **Main Flow**:
    - The simulation instance produces events to the log
    - the event transmitter listens for events that serve as feedback messages to remote endpoints, such as `SimulationInitialized` and `CommandProcessed` events
    - the event transmitter forwards feedback events to the client
    - the remote endpoint receives feedback events
6. **Postcondition**:
    - There are no side-effects from this flow
